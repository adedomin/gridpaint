/*! For license information please see index.bundle.js.LICENSE.txt */
(()=>{var t={598:function(t,e,i){var n,s=s||function(t){"use strict";if(!(void 0===t||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var e=t.document,i=function(){return t.URL||t.webkitURL||t},n=e.createElementNS("http://www.w3.org/1999/xhtml","a"),s="download"in n,o=/constructor/i.test(t.HTMLElement)||t.safari,r=/CriOS\/[\d]+/.test(navigator.userAgent),a=function(e){(t.setImmediate||t.setTimeout)((function(){throw e}),0)},c=function(t){setTimeout((function(){"string"==typeof t?i().revokeObjectURL(t):t.remove()}),4e4)},l=function(t){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob([String.fromCharCode(65279),t],{type:t.type}):t},h=function(e,h,d){d||(e=l(e));var u,p=this,f="application/octet-stream"===e.type,g=function(){!function(t,e,i){for(var n=(e=[].concat(e)).length;n--;){var s=t["on"+e[n]];if("function"==typeof s)try{s.call(t,t)}catch(t){a(t)}}}(p,"writestart progress write writeend".split(" "))};if(p.readyState=p.INIT,s)return u=i().createObjectURL(e),void setTimeout((function(){var t,e;n.href=u,n.download=h,t=n,e=new MouseEvent("click"),t.dispatchEvent(e),g(),c(u),p.readyState=p.DONE}));!function(){if((r||f&&o)&&t.FileReader){var n=new FileReader;return n.onloadend=function(){var e=r?n.result:n.result.replace(/^data:[^;]*;/,"data:attachment/file;");t.open(e,"_blank")||(t.location.href=e),e=void 0,p.readyState=p.DONE,g()},n.readAsDataURL(e),void(p.readyState=p.INIT)}u||(u=i().createObjectURL(e)),f?t.location.href=u:t.open(u,"_blank")||(t.location.href=u),p.readyState=p.DONE,g(),c(u)}()},d=h.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(t,e,i){return e=e||t.name||"download",i||(t=l(t)),navigator.msSaveOrOpenBlob(t,e)}:(d.abort=function(){},d.readyState=d.INIT=0,d.WRITING=1,d.DONE=2,d.error=d.onwritestart=d.onprogress=d.onwrite=d.onabort=d.onerror=d.onwriteend=null,function(t,e,i){return new h(t,e||t.name||"download",i)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);t.exports?t.exports.saveAs=s:null!==i.amdD&&null!==i.amdO&&(void 0===(n=function(){return s}.call(e,i,e,t))||(t.exports=n))},492:function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i);var s=Object.getOwnPropertyDescriptor(e,i);s&&!("get"in s?!e.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,n,s)}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&n(e,t,i);return s(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.GridPaint=void 0;const r=i(425),a=o(i(807)),c=o(i(152)),l=i(143),h=o(i(526)),d=o(i(522)),u=i(199),p=["transparent","#fff","#c0c0c0","#808080","#000","#f00","#800","#ff0","#808000","#0f0","#080","#0ff","#008080","#00f","#000080","#f0f","#800080"],f=16;e.GridPaint=class{constructor(t){this.width=f,this.height=f,this.cellWidth=f,this.cellHeight=f,this.origCellW=f,this.origCellH=f,this.background=!0,this.grid=!1,this.outline=!1,this.isApplied=!1,this.drawing=!1,this.colour=0,this.gridColour="#000",this.palette=p,this.cursor={x:-1,y:-1},this.painting=[[]],this.oldPainting=[[]],this.redoHistory=[],this.undoHistory=[],this.tool="pencil",this.bucket=h.bucket,this.clear=h.clear,this.pencil=h.pencil,this.line=h.line,this.redo=h.redo,this.undo=h.undo,this.applyTool=h.apply,this.line_approx=h.line_approx,this.replace=h.replace,this.compareChanges=h.compare,this.drawBackground=a.background,this.drawCursor=a.cursor,this.drawGrid=a.grid,this.drawPainting=a.painting,this.draw=a.tick,this.saveAs=l.save,this.attachHandlers=c.attach,this.detachHandlers=c.detach,this.resize=d.resize,this.fitToWindow=d.fitToWindow,void 0!==t.width&&(this.width=t.width),void 0!==t.height&&(this.height=t.height),void 0!==t.cellWidth&&(this.cellWidth=t.cellWidth),void 0!==t.cellHeight&&(this.cellHeight=t.cellHeight),void 0!==t.outline&&(this.outline=t.outline),void 0!==t.palette&&t.palette.length>0&&(this.palette=t.palette),this.canvas=(0,r.Canvas)(this.width*this.cellWidth,this.height*this.cellHeight);const e=this.canvas.getContext("2d");if(null===e)throw new Error("Could not get 2d context");this.ctx=e,this.events=c.Handlers(this),this.resizeEvent=this.fitToWindow.bind(this),u.isBrowser&&(this.canvas.className="gridpaint-canvas",this.canvas.style.cursor="crosshair",this.canvas.style.touchAction="none",/firefox/i.test(navigator.userAgent)?this.canvas.style.imageRendering="-moz-crisp-edges":this.canvas.style.imageRendering="pixelated",this.outline&&(this.canvas.style.outlineStyle="solid",this.canvas.style.outlineWidth="2px")),this.boundDraw=this.draw.bind(this),this.clear(!0)}init(){this.attachHandlers(),this.fitToWindow(),this.draw()}destroy(){this.detachHandlers(),this.drawing=!1}setTool(t){this.tool=t,this.line(!0)}action(){switch(this.tool){case"pencil":return this.pencil();case"bucket":return this.bucket();case"line":return this.line();default:console.error("<GridPaint>#action() warning: Unknown tool selected: "+this.tool)}}singleAction(t){switch(this.line(!0),t){case"undo":return this.undo();case"redo":return this.redo();case"clear":return this.clear();default:console.error("<GridPaint>#singleAction() warning: Unknown tool to invoke: "+t)}}}},199:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isBrowser=void 0;let i=!1;e.isBrowser=i,("undefined"==typeof process||"browser"===(null===process||void 0===process?void 0:process.title))&&(e.isBrowser=i=!0)},783:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.bucket=void 0,e.bucket=function(t,e,i){const n=this.colour;e=void 0!==e?e:this.cursor.x,i=void 0!==i?i:this.cursor.y,t=void 0!==t?t:this.painting[i][e];const s=[{x:e,y:i}];for(;0!==s.length;){const{x:e,y:i}=s.pop();t!==n&&this.painting[i][e]===t&&(this.painting[i][e]=n,i+1<this.height&&s.push({x:e,y:i+1}),i-1>-1&&s.push({x:e,y:i-1}),e+1<this.width&&s.push({x:e+1,y:i}),e-1>-1&&s.push({x:e-1,y:i}))}}},425:function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i);var s=Object.getOwnPropertyDescriptor(e,i);s&&!("get"in s?!e.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,n,s)}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&n(e,t,i);return s(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Canvas=void 0;const r=o(i(436)),a=i(199);let c;e.Canvas=c,a.isBrowser?e.Canvas=c=function(t,e){const i=document.createElement("canvas");return i.width=t||300,i.height=e||150,i}:e.Canvas=c=function(t,e){return r.make(t||300,e||150)}},329:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.clear=void 0,e.clear=function(t=!1){this.oldPainting=this.painting.splice(0,this.painting.length);for(let t=0;t<this.height;++t){this.painting.push([]);for(let e=0;e<this.width;++e)this.painting[t].push(0)}t&&(this.oldPainting=this.painting),this.line(!0),this.compareChanges()}},807:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.tick=e.painting=e.grid=e.cursor=e.background=void 0,e.background=function(){let t=!1;const e=this.cellWidth,i=this.cellHeight;for(let n=0;n<2*this.width;n+=1){for(let s=0;s<2*this.height;s+=1)this.ctx.fillStyle=t?"#999999":"#666666",this.ctx.fillRect(n*(e/2),s*(i/2),e/2,i/2),t=!t;t=!t}},e.cursor=function(){if(this.cursor.x<0||this.cursor.y<0)return;const t=this.cellWidth,e=this.cellHeight;for(const{x:i,y:n}of this.line_approx(this.cursor.x,this.cursor.y))this.ctx.globalAlpha=.8,this.ctx.fillStyle=this.palette[this.colour],this.ctx.fillRect(i*t+t/4,n*e,t/2,e),this.ctx.fillRect(i*t,n*e+e/4,t,e/2),this.ctx.globalAlpha=1},e.grid=function(){const t=this.cellWidth,e=this.cellHeight;this.ctx.strokeStyle=this.gridColour;for(let i=0;i<this.width;i+=1)this.ctx.beginPath(),this.ctx.moveTo(i*t+.5,0),this.ctx.lineTo(i*t+.5,e*this.height),this.ctx.stroke();for(let i=0;i<this.height;i+=1)this.ctx.beginPath(),this.ctx.moveTo(0,i*e+.5),this.ctx.lineTo(t*this.width,i*e+.5),this.ctx.stroke()},e.painting=function(t=1,e){var i;const n=this.cellWidth,s=this.cellHeight,o=null!=e?e:this.ctx;for(let e=0;e<this.height;e+=1)for(let r=0;r<this.width;r+=1)o.fillStyle=null!==(i=this.palette[this.painting[e][r]])&&void 0!==i?i:"rgba(0,0,0,0)",o.fillRect(r*n*t,e*s*t,n*t,s*t)},e.tick=function(){this.background?this.drawBackground():this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.drawPainting(),this.drawCursor(),this.grid&&this.drawGrid(),this.drawing&&window.requestAnimationFrame(this.boundDraw)}},152:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.detach=e.attach=e.Handlers=void 0;const n=i(199);function s(t){const e=this.width,i=this.height,n=this.cellWidth,s=this.cellHeight,o=this.canvas.getBoundingClientRect(),r=t.pageX-o.left-window.scrollX,a=t.pageY-o.top-window.scrollY;this.cursor.x=Math.floor(r/e*(e/n)),this.cursor.y=Math.floor(a/i*(i/s))}e.Handlers=function(t){const e=t.action.bind(t),i=t.applyTool.bind(t),n=t.compareChanges.bind(t),o=t.draw.bind(t),r=s.bind(t);return{pointermove(i){i.preventDefault(),r(i),t.isApplied&&e()},pointerdown(e){var n;0===e.button&&(r(e),t.oldPainting=(n=t.painting,JSON.parse(JSON.stringify(n))),i(!0))},pointerup(e){0===e.button&&t.isApplied&&(i(!1),n())},pointerenter(){t.drawing||(t.drawing=!0,o())},pointerout(){t.drawing=!1}}},e.attach=function(){n.isBrowser&&(Object.keys(this.events).forEach((t=>{this.canvas.addEventListener(t,this.events[t],!1)})),window.addEventListener("pointerup",this.events.pointerup,!1),window.addEventListener("resize",this.resizeEvent,!1))},e.detach=function(){n.isBrowser&&(Object.keys(this.events).forEach((t=>{this.canvas.removeEventListener(t,this.events[t],!1)})),window.removeEventListener("pointerup",this.events.pointerup,!1),window.removeEventListener("resize",this.resizeEvent,!1))}},105:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.line=e.line_approx=void 0;const i={x:-1,y:-1};function n(){return-1===i.x||-1===i.y}function s(t=-1,e=-1){i.x=t,i.y=e}function*o(t,e){if(n())yield{x:t,y:e};else{let n=i.x,s=i.y;const o=t,r=e,a=Math.abs(o-n),c=Math.abs(r-s),l=n<o?1:-1,h=s<r?1:-1;let d=a-c;for(;n!==o||s!==r;){yield{x:n,y:s};const t=d<<1;t>-c&&(d-=c,n+=l),t<a&&(d+=a,s+=h)}yield{x:n,y:s}}}e.line_approx=o,e.line=function(t){if(t)return s();if(n())s(this.cursor.x,this.cursor.y);else{for(const{x:t,y:e}of o(this.cursor.x,this.cursor.y))this.painting[e][t]=this.colour;s()}}},324:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.replace=void 0,e.replace=function(t,e){if(t!==e){"string"==typeof t&&(t=this.palette.indexOf(t)),"string"==typeof e&&(e=this.palette.indexOf(e)),this.oldPainting=this.painting.splice(0,this.painting.length);for(let i=0;i<this.height;i+=1){this.painting.push([]);for(let n=0;n<this.width;n+=1){const s=this.oldPainting[i][n];this.painting[i].push(s===t?e:s)}}this.compareChanges()}}},522:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.fitToWindow=e.resize=void 0;const n=i(199);e.resize=function(t=0,e=0){this.canvas.width=this.width*(t||this.cellWidth),this.canvas.height=this.height*(e||this.cellHeight),this.cellWidth=t||this.cellWidth,this.cellHeight=e||this.cellHeight},e.fitToWindow=function(){if(!n.isBrowser)return;if(!this.canvas.parentElement)return;const t=this.origCellW*this.width,e=this.cellWidth/this.cellHeight,i=this.canvas.parentElement.clientWidth,s=this.canvas.width;if(s>i){const t=i/this.width,n=t/e;this.resize(t,n)}else if(s<t&&i<t){const t=i/this.width,n=t/e;this.resize(t,n)}else t>s&&t<i&&this.resize(this.origCellW,this.origCellH);this.drawing||this.draw()}},143:function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i);var s=Object.getOwnPropertyDescriptor(e,i);s&&!("get"in s?!e.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,n,s)}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&n(e,t,i);return s(e,t),e},r=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(s,o){function r(t){try{c(n.next(t))}catch(t){o(t)}}function a(t){try{c(n.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?s(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(r,a)}c((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.save=void 0;const a=o(i(598)),c=i(425),l=i(791),h=o(i(436)),d=i(199);e.save=function(t,e=1){const i=(0,c.Canvas)(this.width*this.cellWidth,this.height*this.cellHeight),n=i.getContext("2d");return null===n?(console.error("<GridPaint>#save() -> Could not get 2d Context."),Promise.reject("<GridPaint>#save() -> Could not get 2d Context.")):(t=null!=t?t:"painting.png",this.drawPainting(e,n),d.isBrowser?":blob:"===t?new Promise((t=>{i.toBlob((e=>{t(e)}),"image/png")})):(i.toBlob((e=>{if(null===e)return console.error("<GridPaint>#save() -> Blob should not be null!"),Promise.reject("<GridPaint>#save() -> Blob should not be null!");a.saveAs(e,t)})),Promise.resolve(null)):function(t){return r(this,void 0,void 0,(function*(){const e=new l.PassThrough,i=[];return e.on("data",(t=>i.push(t))),e.once("end",(function(){})),yield h.encodePNGToStream(t,e),Buffer.concat(i)}))}(n.bitmap))}},526:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.line_approx=e.compare=e.replace=e.apply=e.clear=e.undo=e.redo=e.line=e.bucket=e.pencil=void 0;const n=i(783);Object.defineProperty(e,"bucket",{enumerable:!0,get:function(){return n.bucket}});const s=i(329);Object.defineProperty(e,"clear",{enumerable:!0,get:function(){return s.clear}});const o=i(324);Object.defineProperty(e,"replace",{enumerable:!0,get:function(){return o.replace}});const r=i(105);function a(t,e){if(0===t.length)return;const i=t.pop();null!=i&&(e.push(this.painting.splice(0,this.painting.length)),this.painting=i)}Object.defineProperty(e,"line",{enumerable:!0,get:function(){return r.line}}),Object.defineProperty(e,"line_approx",{enumerable:!0,get:function(){return r.line_approx}}),e.apply=function(t){this.isApplied=void 0!==t?t:!this.isApplied,this.isApplied&&this.action()},e.compare=function(){var t;this.oldPainting.length===this.painting.length&&this.painting.every(((t,e)=>t.toString()===this.oldPainting[e].toString()))||(this.undoHistory.push((t=this.oldPainting,JSON.parse(JSON.stringify(t)))),this.undoHistory.splice(0,this.undoHistory.length-64),this.redoHistory.length=0)},e.pencil=function(){const t=this.cursor.x,e=this.cursor.y;t>=0&&t<this.width&&e>=0&&e<this.height&&(this.painting[e][t]=this.colour)},e.redo=function(){a.apply(this,[this.redoHistory,this.undoHistory])},e.undo=function(){a.apply(this,[this.undoHistory,this.redoHistory])}},436:()=>{},791:()=>{}},e={};function i(n){if(e[n])return e[n].exports;var s=e[n]={exports:{}};return t[n].call(s.exports,s,s.exports,i),s.exports}i.amdD=function(){throw new Error("define cannot be used indirect")},i.amdO={},(()=>{"use strict";const{GridPaint:t}=i(492),e=new t({width:40,height:20});let n,s,o,r,a;document.body.appendChild(e.canvas),n=document.createElement("div"),n.style.marginBottom="6px",e.palette.forEach((function(t,i){const s=document.createElement("button");"transparent"!==t?s.style.backgroundColor=t:(s.style.backgroundImage="\n          linear-gradient(45deg, #999 25%, transparent 25%, transparent 75%, #999 75%, #999 100%),\n          linear-gradient(-45deg, #999 25%, #666 25%, #666 75%, #999 75%, #999 100%)\n        ",s.style.backgroundSize="0.5em 0.5em"),s.style.border="1px solid #000",s.style.marginRight="4px",s.style.color="white",s.innerText=" ",s.title="switch to "+t,s.onclick=function(){e.colour=i,e.drawing||e.draw()},n.appendChild(s)})),document.body.appendChild(n),n=document.createElement("div"),s=["pencil","line","bucket","undo","redo","clear","saveAs"],s.forEach((function(t){const i=document.createElement("button");i.innerText=t,i.onclick=function(){switch(t){case"pencil":case"line":case"bucket":e.setTool(t);break;case"undo":case"redo":case"clear":e.singleAction(t),e.drawing||e.draw();break;case"saveAs":e.saveAs()}},n.appendChild(i)})),document.body.appendChild(n),n=document.createElement("div"),o=document.createElement("select"),r=document.createElement("select"),a=document.createElement("button"),a.innerText="replace",a.onclick=function(){const t=document.getElementsByTagName("select");e.replace(t[0].value,t[1].value),e.drawing||e.draw()},e.palette.forEach((function(t){const e=new Option(t),i=new Option(t);e.style.backgroundColor=t,i.style.backgroundColor=t,o.appendChild(e),r.appendChild(i)})),n.appendChild(o),n.appendChild(r),n.appendChild(a),document.body.appendChild(n),e.init()})()})();